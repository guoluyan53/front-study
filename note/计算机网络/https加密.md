## 一、https如何保证安全？加密方式？公私钥交换过程？

[https是如何保证安全的](https://www.cnblogs.com/kira2022/p/16114218.html)

[HTTPS的加密方式](https://segmentfault.com/a/1190000019687184)

https对数据进行加密。加入一个ssl层。

1. 客户端使用https url访问服务器，则要求web服务器建立ssl连接
2. web服务器接收到客户端的请求后，会将网站证书（证书中包含公钥）返回给客户端。
3. 客户端和web服务器开始协商SSL链接的安全等级，也就是加密等级
4. 客户端浏览器提供双方协商一致的安全等级，建立会话秘钥，然后通过网站的公钥来加密会话秘钥，并传送给网站
5. web服务器通过自己的私钥解密出会话秘钥
6. web服务器提供会话秘钥加密与客户端之间的通信

### 加密的方式

**对称加密**：发送方和接收方使用相同的规则来为数据进行加密，用同样的钥匙来解开密文，这就是对称加密。如果第三方知道加密规则，就很容易破解。

**非对称加密**：用两个秘钥（公钥和私钥）来进行加密和解密，数据经过公钥加密只能被私钥解密，数据经过私钥加密只能用公钥解密。服务端拥有成对的私钥和公钥，然后公布自己的公钥让客户端知道，客户端把自己的数据用公钥加密（加密后只能用服务器的私钥进行解密）

**加密方式**：

**（1）对称加密**：

对于加密和解密使用相同的秘钥。

![图片描述](https://s2.loli.net/2022/04/10/GuLZFMUQEY32pzK.jpg)

![image](https://s2.loli.net/2022/04/10/U6wlI8ar9bqPRti.png)

缺点：在数据传送前，发送方和接收方必须商定好秘钥，然后双方保存好秘钥。但是秘钥可能会被第三方截取。不安全！！

**（2）非对称加密**

加密和解密可以使用不同的规则，只要这两种规则之间存在某种对应关系就可以。

**用公钥进行加密，用私钥进行解密**

![图片描述](https://s2.loli.net/2022/04/10/TWYQFyJAOEUd67s.jpg)

![image](https://s2.loli.net/2022/04/10/YPKZO9MXemnchbG.png)

缺点：加密和解密花费时间长、速度慢、只适合对少量数据进行加密。

### 数字证书

- `签名`：使用一种Hash算法来对公钥和其他信息进行加密，生成一个信息摘要，然后让有公信力的认证中心（CA，证书授权中心）用它的私钥对消息摘要进行加密，形成签名。
- `数字证书`：将原始的信息和签名合在一起，称为数字证书。

证书中包括：签发者、证书用途、使用者公钥、使用者私钥、使用者的HASH算法、证书到期时间等。

当接受方收到数字证书的时候，先根据原始信息使用同样的Hash算法生成一个摘要，然后使用公证处的公钥来对数字证书中的摘要进行解密，最后将解密的摘要和生成的摘要进行对比，就能发现得到的信息是否被更改了。这个方法最重要的是认证中心的可靠性，一般浏览器里会内置一些顶层的认证中心的证书，相当于我们自动信任了他们，只有这样才能保证数据的安全。

### https加密解决方案

利用对称加密、非对称加密，可完成可信任的信息传输

1. 利用 非对称加密 加密传输 对称加密所约定的秘钥（保证了秘钥传输的安全）
2. 后续，利用对称加密，有效便捷的进行数据传输！！

**哈哈哈哈，其实非对称性加密也有不安全的地方**：

![图片描述](https://s2.loli.net/2022/04/10/ZMSj3dzKA7sTGRw.jpg)

**公私钥的交换过程**：

引入证书（CA）。

![图片描述](https://s2.loli.net/2022/04/10/Z7sgjMN14F8CuvL.png)

过程：

1. 服务器产生公私钥
2. 将公私钥发送给CA
3. CA生成客户端浏览器公私钥
4. CA使用客户端浏览器的私钥对服务器的公钥进行加密，得到证书，返回给服务器
5. CA将证书发给客户端
6. 服务器发送公钥与证书给客户端
7. 客户端利用私钥对证书解密，对比服务端公钥，确认来源无误
8. 客户端生成随机密码，保存在本地，然后使用服务端公钥加密
9. 将加密的密码返回给服务端
10. 服务端使用私钥解密得到客户端密码
11. 此时完成了密码交换工作
12. 此后进行的所有数据交换都会事先使用这个密码进行称加密，如DES，3DES。
13. 总结：对密钥进行非对称加密，后使用密钥进行对称加密

